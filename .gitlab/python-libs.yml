# Python frameworks on which exciting depends
# * excitingtools 
# * Regression testing framework

python:excitingtools-python-3.7:
  image: gitdocker.physik.hu-berlin.de/sol/exciting:debian-buster-GCC8-April2022
  stage: python
  tags:
    - docker
  before_script:
    - apt-get update && apt-get install -y python3-pip
    - pip3 install pylint
  script:
    - cd tools/exciting_tools && pip3 install -e .
    - pytest
  after_script:
    # Run pylint on all modified python files
    - sh .gitlab/run_pylint.sh $CI_BUILD_REF_NAME

python:regressionframework-python-3.7:
  image: gitdocker.physik.hu-berlin.de/sol/exciting:debian-buster-GCC8-April2022
  stage: python
  tags:
    - docker
  before_script:
    # Can do as excitingtools and only retain `python3-pip`, but maybe this is more consistent(?)
    - apt-get --allow-releaseinfo-change update && apt-get install -y libpython3.7 libpython3.7-dev python3-pip    
  script:
    - pip3 install -e tools/exciting_tools
    - cd test/ && pytest test_functions/
